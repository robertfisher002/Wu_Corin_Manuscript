#### Alignment
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-c3-input_R1_001.fastq -2 10-c3-input_R2_001.fastq> M10-R_corin_Input_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-c4-input_R1_001.fastq -2 10-c4-input_R2_001.fastq> M10-R_corin_Input_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-cx-3_R1_001.fastq -2 10-cx-3_R2_001.fastq> M10-R_corin_H3K9ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-cx-4_R1_001.fastq -2 10-cx-4_R2_001.fastq> M10-R_corin_H3K9ac_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-cy-3_R1_001.fastq -2 10-cy-3_R2_001.fastq> M10-R_corin_H3K4me2_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-cy-4_R1_001.fastq -2 10-cy-4_R2_001.fastq> M10-R_corin_H3K4me2_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-cz-3_R1_001.fastq -2 10-cz-3_R2_001.fastq> M10-R_corin_H3K27ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-cz-4_R1_001.fastq -2 10-cz-4_R2_001.fastq> M10-R_corin_H3K27ac_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-d3-input_R1_001.fastq -2 10-d3-input_R2_001.fastq> M10-R_DMSO_Input_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-d4-input_R1_001.fastq -2 10-d4-input_R2_001.fastq> M10-R_DMSO_Input_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-dx-3_R1_001.fastq -2 10-dx-3_R2_001.fastq> M10-R_DMSO_H3K9ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-dx-4_R1_001.fastq -2 10-dx-4_R2_001.fastq> M10-R_DMSO_H3K9ac_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-dy-3_R1_001.fastq -2 10-dy-3_R2_001.fastq> M10-R_DMSO_H3K4me2_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-dy-4_R1_001.fastq -2 10-dy-4_R2_001.fastq> M10-R_DMSO_H3K4me2_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-dz-3_R1_001.fastq -2 10-dz-3_R2_001.fastq> M10-R_DMSO_H3K27ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 10-dz-4_R1_001.fastq -2 10-dz-4_R2_001.fastq> M10-R_DMSO_H3K27ac_R4.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-c1-input_R1_001.fastq -2 13-c1-input_R2_001.fastq> M13-R_corin_Input_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-c3-input_R1_001.fastq -2 13-c3-input_R2_001.fastq> M13-R_corin_Input_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-cx-1_R1_001.fastq -2 13-cx-1_R2_001.fastq> M13-R_corin_H3K9ac_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-cx-3_R1_001.fastq -2 13-cx-3_R2_001.fastq> M13-R_corin_H3K9ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-cy-1_R1_001.fastq -2 13-cy-1_R2_001.fastq> M13-R_corin_H3K4me2_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-cy-3_R1_001.fastq -2 13-cy-3_R2_001.fastq> M13-R_corin_H3K4me2_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-cz-1_R1_001.fastq -2 13-cz-1_R2_001.fastq> M13-R_corin_H3K27ac_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-cz-3_R1_001.fastq -2 13-cz-3_R2_001.fastq> M13-R_corin_H3K27ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-d1-input_R1_001.fastq -2 13-d1-input_R2_001.fastq> M13-R_DMSO_Input_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-d3-input_R1_001.fastq -2 13-d3-input_R2_001.fastq> M13-R_DMSO_Input_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-dx-1_R1_001.fastq -2 13-dx-1_R2_001.fastq> M13-R_DMSO_H3K9ac_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-dx-3_R1_001.fastq -2 13-dx-3_R2_001.fastq> M13-R_DMSO_H3K9ac_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-dy-1_R1_001.fastq -2 13-dy-1_R2_001.fastq> M13-R_DMSO_H3K4me2_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-dy-3_R1_001.fastq -2 13-dy-3_R2_001.fastq> M13-R_DMSO_H3K4me2_R3.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-dz-1_R1_001.fastq -2 13-dz-1_R2_001.fastq> M13-R_DMSO_H3K27ac_R1.sam;
bowtie2 -p 48 -x /work/02219/beck310/___genome.files/Homo_sapiens/UCSC/hg38/Sequence/Bowtie2Index/genome -1 13-dz-3_R1_001.fastq -2 13-dz-3_R2_001.fastq> M13-R_DMSO_H3K27ac_R3.sam;

#### peak calling with MACS14
macs14 -t M13-R_DMSO_H3K9ac_R1.sam -c M13-R_DMSO_Input_R1.sam -n M13-R_DMSO_H3K9ac_R1 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_DMSO_H3K4me2_R1.sam -c M13-R_DMSO_Input_R1.sam -n M13-R_DMSO_H3K4me2_R1 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_DMSO_H3K27ac_R1.sam -c M13-R_DMSO_Input_R1.sam -n M13-R_DMSO_H3K27ac_R1 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_corin_H3K9ac_R1.sam -c M13-R_corin_Input_R1.sam -n M13-R_corin_H3K9ac_R1 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_corin_H3K4me2_R1.sam -c M13-R_corin_Input_R1.sam -n M13-R_corin_H3K4me2_R1 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_corin_H3K27ac_R1.sam -c M13-R_corin_Input_R1.sam -n M13-R_corin_H3K27ac_R1 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_DMSO_H3K9ac_R3.sam -c M13-R_DMSO_Input_R3.sam -n M13-R_DMSO_H3K9ac_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_DMSO_H3K4me2_R3.sam -c M13-R_DMSO_Input_R3.sam -n M13-R_DMSO_H3K4me2_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M13-R_DMSO_H3K27ac_R3.sam -c M13-R_DMSO_Input_R3.sam -n M13-R_DMSO_H3K27ac_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_DMSO_H3K9ac_R3.sam -c M10-R_DMSO_Input_R3.sam -n M10-R_DMSO_H3K9ac_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_DMSO_H3K4me2_R3.sam -c M10-R_DMSO_Input_R3.sam -n M10-R_DMSO_H3K4me2_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_DMSO_H3K27ac_R3.sam -c M10-R_DMSO_Input_R3.sam -n M10-R_DMSO_H3K27ac_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_corin_H3K9ac_R3.sam -c M10-R_corin_Input_R3.sam -n M10-R_corin_H3K9ac_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_corin_H3K4me2_R3.sam -c M10-R_corin_Input_R3.sam -n M10-R_corin_H3K4me2_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_corin_H3K27ac_R3.sam -c M10-R_corin_Input_R3.sam -n M10-R_corin_H3K27ac_R3 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_DMSO_H3K9ac_R4.sam -c M10-R_DMSO_Input_R4.sam -n M10-R_DMSO_H3K9ac_R4 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_DMSO_H3K4me2_R4.sam -c M10-R_DMSO_Input_R4.sam -n M10-R_DMSO_H3K4me2_R4 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_DMSO_H3K27ac_R4.sam -c M10-R_DMSO_Input_R4.sam -n M10-R_DMSO_H3K27ac_R4 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_corin_H3K9ac_R4.sam -c M10-R_corin_Input_R4.sam -n M10-R_corin_H3K9ac_R4 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_corin_H3K4me2_R4.sam -c M10-R_corin_Input_R4.sam -n M10-R_corin_H3K4me2_R4 -g hs --nomodel --nolambda -B -S;
macs14 -t M10-R_corin_H3K27ac_R4.sam -c M10-R_corin_Input_R4.sam -n M10-R_corin_H3K27ac_R4 -g hs --nomodel --nolambda -B -S;

#### sam to bam for spikeinfree normalization
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_H3K27ac_R3.sam > M10-R_corin_H3K27ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_H3K27ac_R4.sam > M10-R_corin_H3K27ac_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_H3K4me2_R3.sam > M10-R_corin_H3K4me2_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_H3K4me2_R4.sam > M10-R_corin_H3K4me2_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_H3K9ac_R3.sam > M10-R_corin_H3K9ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_H3K9ac_R4.sam > M10-R_corin_H3K9ac_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_Input_R3.sam > M10-R_corin_Input_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_corin_Input_R4.sam > M10-R_corin_Input_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_H3K27ac_R3.sam > M10-R_DMSO_H3K27ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_H3K27ac_R4.sam > M10-R_DMSO_H3K27ac_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_H3K4me2_R3.sam > M10-R_DMSO_H3K4me2_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_H3K4me2_R4.sam > M10-R_DMSO_H3K4me2_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_H3K9ac_R3.sam > M10-R_DMSO_H3K9ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_H3K9ac_R4.sam > M10-R_DMSO_H3K9ac_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_Input_R3.sam > M10-R_DMSO_Input_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M10-R_DMSO_Input_R4.sam > M10-R_DMSO_Input_R4.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_H3K27ac_R1.sam > M13-R_corin_H3K27ac_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_H3K27ac_R3.sam > M13-R_corin_H3K27ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_H3K4me2_R1.sam > M13-R_corin_H3K4me2_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_H3K4me2_R3.sam > M13-R_corin_H3K4me2_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_H3K9ac_R1.sam > M13-R_corin_H3K9ac_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_H3K9ac_R3.sam > M13-R_corin_H3K9ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_Input_R1.sam > M13-R_corin_Input_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_corin_Input_R3.sam > M13-R_corin_Input_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_H3K27ac_R1.sam > M13-R_DMSO_H3K27ac_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_H3K27ac_R3.sam > M13-R_DMSO_H3K27ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_H3K4me2_R1.sam > M13-R_DMSO_H3K4me2_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_H3K4me2_R3.sam > M13-R_DMSO_H3K4me2_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_H3K9ac_R1.sam > M13-R_DMSO_H3K9ac_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_H3K9ac_R3.sam > M13-R_DMSO_H3K9ac_R3.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_Input_R1.sam > M13-R_DMSO_Input_R1.mapped.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -bS -F 0x04 M13-R_DMSO_Input_R3.sam > M13-R_DMSO_Input_R3.mapped.bam;

#### duplicate removal for spikeinfree normalization
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_H3K27ac_R3.mappedq1.bam O=M10-R_corin_H3K27ac_R3.mappedq1.rmdup.bam M=M10-R_corin_H3K27ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_H3K27ac_R4.mappedq1.bam O=M10-R_corin_H3K27ac_R4.mappedq1.rmdup.bam M=M10-R_corin_H3K27ac_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_H3K4me2_R3.mappedq1.bam O=M10-R_corin_H3K4me2_R3.mappedq1.rmdup.bam M=M10-R_corin_H3K4me2_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_H3K4me2_R4.mappedq1.bam O=M10-R_corin_H3K4me2_R4.mappedq1.rmdup.bam M=M10-R_corin_H3K4me2_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_H3K9ac_R3.mappedq1.bam O=M10-R_corin_H3K9ac_R3.mappedq1.rmdup.bam M=M10-R_corin_H3K9ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_H3K9ac_R4.mappedq1.bam O=M10-R_corin_H3K9ac_R4.mappedq1.rmdup.bam M=M10-R_corin_H3K9ac_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_Input_R3.mappedq1.bam O=M10-R_corin_Input_R3.mappedq1.rmdup.bam M=M10-R_corin_Input_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_corin_Input_R4.mappedq1.bam O=M10-R_corin_Input_R4.mappedq1.rmdup.bam M=M10-R_corin_Input_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_H3K27ac_R3.mappedq1.bam O=M10-R_DMSO_H3K27ac_R3.mappedq1.rmdup.bam M=M10-R_DMSO_H3K27ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_H3K27ac_R4.mappedq1.bam O=M10-R_DMSO_H3K27ac_R4.mappedq1.rmdup.bam M=M10-R_DMSO_H3K27ac_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_H3K4me2_R3.mappedq1.bam O=M10-R_DMSO_H3K4me2_R3.mappedq1.rmdup.bam M=M10-R_DMSO_H3K4me2_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_H3K4me2_R4.mappedq1.bam O=M10-R_DMSO_H3K4me2_R4.mappedq1.rmdup.bam M=M10-R_DMSO_H3K4me2_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_H3K9ac_R3.mappedq1.bam O=M10-R_DMSO_H3K9ac_R3.mappedq1.rmdup.bam M=M10-R_DMSO_H3K9ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_H3K9ac_R4.mappedq1.bam O=M10-R_DMSO_H3K9ac_R4.mappedq1.rmdup.bam M=M10-R_DMSO_H3K9ac_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_Input_R3.mappedq1.bam O=M10-R_DMSO_Input_R3.mappedq1.rmdup.bam M=M10-R_DMSO_Input_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M10-R_DMSO_Input_R4.mappedq1.bam O=M10-R_DMSO_Input_R4.mappedq1.rmdup.bam M=M10-R_DMSO_Input_R4.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_H3K27ac_R1.mappedq1.bam O=M13-R_corin_H3K27ac_R1.mappedq1.rmdup.bam M=M13-R_corin_H3K27ac_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_H3K27ac_R3.mappedq1.bam O=M13-R_corin_H3K27ac_R3.mappedq1.rmdup.bam M=M13-R_corin_H3K27ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_H3K4me2_R1.mappedq1.bam O=M13-R_corin_H3K4me2_R1.mappedq1.rmdup.bam M=M13-R_corin_H3K4me2_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_H3K4me2_R3.mappedq1.bam O=M13-R_corin_H3K4me2_R3.mappedq1.rmdup.bam M=M13-R_corin_H3K4me2_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_H3K9ac_R1.mappedq1.bam O=M13-R_corin_H3K9ac_R1.mappedq1.rmdup.bam M=M13-R_corin_H3K9ac_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_H3K9ac_R3.mappedq1.bam O=M13-R_corin_H3K9ac_R3.mappedq1.rmdup.bam M=M13-R_corin_H3K9ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_Input_R1.mappedq1.bam O=M13-R_corin_Input_R1.mappedq1.rmdup.bam M=M13-R_corin_Input_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_corin_Input_R3.mappedq1.bam O=M13-R_corin_Input_R3.mappedq1.rmdup.bam M=M13-R_corin_Input_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_H3K27ac_R1.mappedq1.bam O=M13-R_DMSO_H3K27ac_R1.mappedq1.rmdup.bam M=M13-R_DMSO_H3K27ac_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_H3K27ac_R3.mappedq1.bam O=M13-R_DMSO_H3K27ac_R3.mappedq1.rmdup.bam M=M13-R_DMSO_H3K27ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_H3K4me2_R1.mappedq1.bam O=M13-R_DMSO_H3K4me2_R1.mappedq1.rmdup.bam M=M13-R_DMSO_H3K4me2_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_H3K4me2_R3.mappedq1.bam O=M13-R_DMSO_H3K4me2_R3.mappedq1.rmdup.bam M=M13-R_DMSO_H3K4me2_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_H3K9ac_R1.mappedq1.bam O=M13-R_DMSO_H3K9ac_R1.mappedq1.rmdup.bam M=M13-R_DMSO_H3K9ac_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_H3K9ac_R3.mappedq1.bam O=M13-R_DMSO_H3K9ac_R3.mappedq1.rmdup.bam M=M13-R_DMSO_H3K9ac_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_Input_R1.mappedq1.bam O=M13-R_DMSO_Input_R1.mappedq1.rmdup.bam M=M13-R_DMSO_Input_R1.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;
java -jar picard.jar.1 MarkDuplicates I=M13-R_DMSO_Input_R3.mappedq1.bam O=M13-R_DMSO_Input_R3.mappedq1.rmdup.bam M=M13-R_DMSO_Input_R3.mappedq1.rmdup.metrics.txt CREATE_INDEX=true ASSUME_SORTED=false REMOVE_DUPLICATES=true;

#### low quality read removal for spikeinfree normalization
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_H3K27ac_R3.mapped.rmdup.bam > M10-R_corin_H3K27ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_H3K27ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_H3K27ac_R4.mapped.rmdup.bam > M10-R_corin_H3K27ac_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_H3K27ac_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_H3K4me2_R3.mapped.rmdup.bam > M10-R_corin_H3K4me2_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_H3K4me2_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_H3K4me2_R4.mapped.rmdup.bam > M10-R_corin_H3K4me2_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_H3K4me2_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_H3K9ac_R3.mapped.rmdup.bam > M10-R_corin_H3K9ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_H3K9ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_H3K9ac_R4.mapped.rmdup.bam > M10-R_corin_H3K9ac_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_H3K9ac_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_Input_R3.mapped.rmdup.bam > M10-R_corin_Input_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_Input_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_corin_Input_R4.mapped.rmdup.bam > M10-R_corin_Input_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_corin_Input_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_H3K27ac_R3.mapped.rmdup.bam > M10-R_DMSO_H3K27ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_H3K27ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_H3K27ac_R4.mapped.rmdup.bam > M10-R_DMSO_H3K27ac_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_H3K27ac_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_H3K4me2_R3.mapped.rmdup.bam > M10-R_DMSO_H3K4me2_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_H3K4me2_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_H3K4me2_R4.mapped.rmdup.bam > M10-R_DMSO_H3K4me2_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_H3K4me2_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_H3K9ac_R3.mapped.rmdup.bam > M10-R_DMSO_H3K9ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_H3K9ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_H3K9ac_R4.mapped.rmdup.bam > M10-R_DMSO_H3K9ac_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_H3K9ac_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_Input_R3.mapped.rmdup.bam > M10-R_DMSO_Input_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_Input_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M10-R_DMSO_Input_R4.mapped.rmdup.bam > M10-R_DMSO_Input_R4.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M10-R_DMSO_Input_R4.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_H3K27ac_R1.mapped.rmdup.bam > M13-R_corin_H3K27ac_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_H3K27ac_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_H3K27ac_R3.mapped.rmdup.bam > M13-R_corin_H3K27ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_H3K27ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_H3K4me2_R1.mapped.rmdup.bam > M13-R_corin_H3K4me2_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_H3K4me2_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_H3K4me2_R3.mapped.rmdup.bam > M13-R_corin_H3K4me2_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_H3K4me2_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_H3K9ac_R1.mapped.rmdup.bam > M13-R_corin_H3K9ac_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_H3K9ac_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_H3K9ac_R3.mapped.rmdup.bam > M13-R_corin_H3K9ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_H3K9ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_Input_R1.mapped.rmdup.bam > M13-R_corin_Input_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_Input_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_corin_Input_R3.mapped.rmdup.bam > M13-R_corin_Input_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_corin_Input_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_H3K27ac_R1.mapped.rmdup.bam > M13-R_DMSO_H3K27ac_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_H3K27ac_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_H3K27ac_R3.mapped.rmdup.bam > M13-R_DMSO_H3K27ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_H3K27ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_H3K4me2_R1.mapped.rmdup.bam > M13-R_DMSO_H3K4me2_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_H3K4me2_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_H3K4me2_R3.mapped.rmdup.bam > M13-R_DMSO_H3K4me2_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_H3K4me2_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_H3K9ac_R1.mapped.rmdup.bam > M13-R_DMSO_H3K9ac_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_H3K9ac_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_H3K9ac_R3.mapped.rmdup.bam > M13-R_DMSO_H3K9ac_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_H3K9ac_R3.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_Input_R1.mapped.rmdup.bam > M13-R_DMSO_Input_R1.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_Input_R1.mapped.rmdupq1.bam;
singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -hb -q 1 M13-R_DMSO_Input_R3.mapped.rmdup.bam > M13-R_DMSO_Input_R3.mapped.rmdupq1.bam;singularity exec /work/projects/singularity/TACC/biocontainers/samtools_1.6--0.img samtools view -H M13-R_DMSO_Input_R3.mapped.rmdupq1.bam;

#### Run spikein normalization
Rscript sample_meta_M10_R3.r
Rscript sample_meta_M10_R4.r
Rscript sample_meta_M13_R1.r
Rscript sample_meta_M13_R3.r

#### Generate normalized graph file
bedtools genomecov -ibam M10-R_corin_H3K27ac_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_H3K27ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_H3K27ac_R4.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_H3K27ac_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_H3K4me2_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_H3K4me2_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_H3K4me2_R4.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_H3K4me2_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_H3K9ac_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_H3K9ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_H3K9ac_R4.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_H3K9ac_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_Input_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_Input_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_corin_Input_R4.mappedq1.sort.rmdup.bam -scale 1 -bga >M10-R_corin_Input_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_H3K27ac_R3.mappedq1.sort.rmdup.bam -scale 0.367647059 -bga >M10-R_DMSO_H3K27ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_H3K27ac_R4.mappedq1.sort.rmdup.bam -scale 0.27027027 -bga >M10-R_DMSO_H3K27ac_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_H3K4me2_R3.mappedq1.sort.rmdup.bam -scale 0.641025641 -bga >M10-R_DMSO_H3K4me2_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_H3K4me2_R4.mappedq1.sort.rmdup.bam -scale 0.775193798 -bga >M10-R_DMSO_H3K4me2_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_H3K9ac_R3.mappedq1.sort.rmdup.bam -scale 0.245700246 -bga >M10-R_DMSO_H3K9ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_H3K9ac_R4.mappedq1.sort.rmdup.bam -scale 0.212765957 -bga >M10-R_DMSO_H3K9ac_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_Input_R3.mappedq1.sort.rmdup.bam -scale 0.943396226 -bga >M10-R_DMSO_Input_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M10-R_DMSO_Input_R4.mappedq1.sort.rmdup.bam -scale 0.943396226 -bga >M10-R_DMSO_Input_R4.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_H3K27ac_R1.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_corin_H3K27ac_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_H3K27ac_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_corin_H3K27ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_H3K4me2_R1.mappedq1.sort.rmdup.bam -scale 0.826446281 -bga >M13-R_corin_H3K4me2_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_H3K4me2_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_corin_H3K4me2_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_H3K9ac_R1.mappedq1.sort.rmdup.bam -scale 0.666666667 -bga >M13-R_corin_H3K9ac_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_H3K9ac_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_corin_H3K9ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_Input_R1.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_corin_Input_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_corin_Input_R3.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_corin_Input_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_H3K27ac_R1.mappedq1.sort.rmdup.bam -scale 0.186567164 -bga >M13-R_DMSO_H3K27ac_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_H3K27ac_R3.mappedq1.sort.rmdup.bam -scale 0.207900208 -bga >M13-R_DMSO_H3K27ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_H3K4me2_R1.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_DMSO_H3K4me2_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_H3K4me2_R3.mappedq1.sort.rmdup.bam -scale 0.657894737 -bga >M13-R_DMSO_H3K4me2_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_H3K9ac_R1.mappedq1.sort.rmdup.bam -scale 1 -bga >M13-R_DMSO_H3K9ac_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_H3K9ac_R3.mappedq1.sort.rmdup.bam -scale 0.67114094 -bga >M13-R_DMSO_H3K9ac_R3.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_Input_R1.mappedq1.sort.rmdup.bam -scale 0.787401575 -bga >M13-R_DMSO_Input_R1.rmdup.scalefreenorm.bedgraph;
bedtools genomecov -ibam M13-R_DMSO_Input_R3.mappedq1.sort.rmdup.bam -scale 0.980392157 -bga >M13-R_DMSO_Input_R3.rmdup.scalefreenorm.bedgraph;

#### get signal profile
annotatePeaks.pl M10.d.dc.c.H3K27ac..062222.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K27ac_R3.rmdup.spikeinfree1e7norm.bedgraph M10-R_corin_H3K27ac_R3.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M10-R_H3K27ac_R3.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K27ac..062922.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K27ac_R4.rmdup.spikeinfree1e7norm.bedgraph M10-R_corin_H3K27ac_R4.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M10-R_H3K27ac_R4.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K4me2..062222.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K4me2_R3.rmdup.spikeinfree1e7norm.bedgraph M10-R_corin_H3K4me2_R3.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M10-R_H3K4me2_R3.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K4me2..062922.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K4me2_R4.rmdup.spikeinfree1e7norm.bedgraph M10-R_corin_H3K4me2_R4.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M10-R_H3K4me2_R4.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K9ac..062222.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K9ac_R3.rmdup.spikeinfree1e7norm.bedgraph M10-R_corin_H3K9ac_R3.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M10-R_H3K9ac_R3.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K9ac..062922.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K9ac_R4.rmdup.spikeinfree1e7norm.bedgraph M10-R_corin_H3K9ac_R4.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M10-R_H3K9ac_R4.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K27ac..062222.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K27ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M10-R_corin_H3K27ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M10-R_H3K27ac_R3.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K27ac..062922.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K27ac_R4.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M10-R_corin_H3K27ac_R4.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M10-R_H3K27ac_R4.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K4me2..062222.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K4me2_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M10-R_corin_H3K4me2_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M10-R_H3K4me2_R3.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K4me2..062922.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K4me2_R4.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M10-R_corin_H3K4me2_R4.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M10-R_H3K4me2_R4.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K9ac..062222.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K9ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M10-R_corin_H3K9ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M10-R_H3K9ac_R3.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M10.d.dc.c.H3K9ac..062922.sigsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M10-R_DMSO_H3K9ac_R4.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M10-R_corin_H3K9ac_R4.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M10-R_H3K9ac_R4.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K27ac..060322.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K27ac_R1.rmdup.spikeinfree1e7norm.bedgraph M13-R_corin_H3K27ac_R1.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M13-R_H3K27ac_R1.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K27ac..062222.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K27ac_R3.rmdup.spikeinfree1e7norm.bedgraph M13-R_corin_H3K27ac_R3.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M13-R_H3K27ac_R3.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K4me2..060322.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K4me2_R1.rmdup.spikeinfree1e7norm.bedgraph M13-R_corin_H3K4me2_R1.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M13-R_H3K4me2_R1.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K4me2..062222.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K4me2_R3.rmdup.spikeinfree1e7norm.bedgraph M13-R_corin_H3K4me2_R3.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M13-R_H3K4me2_R3.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K9ac..060322.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K9ac_R1.rmdup.spikeinfree1e7norm.bedgraph M13-R_corin_H3K9ac_R1.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M13-R_H3K9ac_R1.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K9ac..062222.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K9ac_R3.rmdup.spikeinfree1e7norm.bedgraph M13-R_corin_H3K9ac_R3.rmdup.spikeinfree1e7norm.bedgraph -hist 25 -ghist > M13-R_H3K9ac_R3.rmdup.spikeinfreenorm.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K27ac..060322.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K27ac_R1.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M13-R_corin_H3K27ac_R1.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M13-R_H3K27ac_R1.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K27ac..062222.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K27ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M13-R_corin_H3K27ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M13-R_H3K27ac_R3.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K4me2..060322.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K4me2_R1.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M13-R_corin_H3K4me2_R1.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M13-R_H3K4me2_R1.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K4me2..062222.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K4me2_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M13-R_corin_H3K4me2_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M13-R_H3K4me2_R3.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K9ac..060322.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K9ac_R1.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M13-R_corin_H3K9ac_R1.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M13-R_H3K9ac_R1.rmdup.spikeinfreenorm.logLR.10ksig;
annotatePeaks.pl M13.d.dc.c.H3K9ac..062222.signalsort.organizedshuffle.bed hg38 -size 10000 -bedGraph M13-R_DMSO_H3K9ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph M13-R_corin_H3K9ac_R3.rmdup.spikeinfree1e7norm.logLRrminfnan.bedgraph -hist 25 -ghist > M13-R_H3K9ac_R3.rmdup.spikeinfreenorm.logLR.10ksig;

#### Matching RNA-seq data and ChIP profile
> perl maketable.pl
